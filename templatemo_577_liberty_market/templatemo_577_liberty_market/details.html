<!DOCTYPE html>

<html lang="en">
<head>
<meta charset="utf-8"/>
<meta content="templatemo" name="author"/>
<meta content="width=device-width, initial-scale=1, shrink-to-fit=no" name="viewport"/>
<link href="https://fonts.googleapis.com/css2?family=Roboto:wght@100;300;400;500;700;900&amp;display=swap" rel="stylesheet"/>
<title>Liberty Market - Item Details</title>
<!-- Bootstrap core CSS -->
<link href="vendor/bootstrap/css/bootstrap.min.css" rel="stylesheet"/>
<link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.css" rel="stylesheet"/>
<!-- Additional CSS Files -->
<link href="assets/css/fontawesome.css" rel="stylesheet"/>
<link href="assets/css/templatemo-liberty-market.css" rel="stylesheet"/>
<link href="assets/css/owl.css" rel="stylesheet"/>
<link href="assets/css/animate.css" rel="stylesheet"/>
<link href="assets/css/modern-header.css" rel="stylesheet"/>
<link href="https://unpkg.com/swiper@7/swiper-bundle.min.css" rel="stylesheet">

<!-- Security Check Script -->




<style>
/* Add these styles for better UI/UX */
.item-details-page .left-image img {
    transition: transform 0.3s ease;
}

.item-details-page .left-image img:hover {
    transform: scale(1.02);
}

.main-button, .border-button {
    transition: all 0.3s ease;
}

.main-button:hover, .border-button:hover {
    transform: translateY(-2px);
    box-shadow: 0 4px 8px rgba(0,0,0,0.2);
}

.side-nav-item {
    transition: all 0.3s ease;
}

.side-nav-item:hover {
    background: rgba(255,255,255,0.1);
    transform: translateX(5px);
}

.menu-trigger span {
    transition: all 0.3s ease;
}

.menu-trigger.active span:nth-child(1) {
    transform: rotate(45deg) translate(5px, 5px);
}

.menu-trigger.active span:nth-child(2) {
    opacity: 0;
}

.menu-trigger.active span:nth-child(3) {
    transform: rotate(-45deg) translate(7px, -6px);
}

/* Mobile Menu Styles */
.mobile-menu-trigger {
    display: none;
    width: 30px;
    height: 25px;
    position: relative;
    cursor: pointer;
    margin-right: 15px;
}

.mobile-menu-trigger span {
    display: block;
    position: absolute;
    height: 3px;
    width: 100%;
    background: #7453fc;
    border-radius: 3px;
    transition: 0.25s ease-in-out;
}

.mobile-menu-trigger span:nth-child(1) { top: 0; }
.mobile-menu-trigger span:nth-child(2) { top: 10px; }
.mobile-menu-trigger span:nth-child(3) { top: 20px; }

/* Active State */
.mobile-menu-trigger.active span:nth-child(1) {
    top: 10px;
    transform: rotate(45deg);
}

.mobile-menu-trigger.active span:nth-child(2) {
    opacity: 0;
}

.mobile-menu-trigger.active span:nth-child(3) {
    top: 10px;
    transform: rotate(-45deg);
}

@media (max-width: 991px) {
    .mobile-menu-trigger {
        display: block;
    }

    .nav {
        display: none;
        position: absolute;
        top: 80px;
        left: 0;
        width: 100%;
        background: rgba(255, 255, 255, 0.95);
        padding: 20px 0;
        box-shadow: 0 2px 15px rgba(0,0,0,0.1);
    }

    .nav.active {
        display: block;
    }

    .nav li {
        display: block;
        margin: 0;
        padding: 8px 25px;
    }

    .nav li a {
        display: block;
        padding: 8px 0;
        color: #7453fc;
    }
}
</style>
</head>



<body>
<!-- Common JavaScript Functions -->
<script src="assets/js/common.js"></script>
<script src="assets/js/auth.js"></script>
<script>
// Test if common.js is loaded
console.log('Common.js loaded, updateUserBalance function:', typeof updateUserBalance);
console.log('Common.js loaded, getCategoryClass function:', typeof getCategoryClass);
</script>

<div class="user-account-info" id="userAccountInfo">
    <div class="user-profile-pic">
        <img src="assets/images/author.jpg" alt="Profile" id="userProfilePic">
    </div>
    <div class="user-balance-info">
        <div class="balance-amount" id="userBalanceAmount">â‚¹0</div>
        <div class="balance-label">Available Balance</div>
    </div>
</div>

<script>
window.addEventListener('load', function() {
    const header = document.querySelector('.header-area .main-nav');
    if (header) {
        // Add menu trigger if it doesn't exist
        let menuTrigger = header.querySelector('.menu-trigger');
        
        if (!menuTrigger) {
            menuTrigger = document.createElement('a');
            menuTrigger.className = 'menu-trigger';
            menuTrigger.href = '#';
            
            // Create hamburger icon
            const span1 = document.createElement('span');
            const span2 = document.createElement('span');
            const span3 = document.createElement('span');
            
            menuTrigger.appendChild(span1);
            menuTrigger.appendChild(span2);
            menuTrigger.appendChild(span3);
            
            // Add menu trigger to header
            header.appendChild(menuTrigger);
        }
        
        // Add click event to menu trigger
        menuTrigger.addEventListener('click', function(e) {
            e.preventDefault();
            this.classList.toggle('active');
            const nav = header.querySelector('.nav');
            if (nav) {
                nav.classList.toggle('active');
            }
        });

        // Close menu when clicking outside
        document.addEventListener('click', function(e) {
            if (!e.target.closest('.nav') && !e.target.closest('.menu-trigger')) {
                menuTrigger.classList.remove('active');
                const nav = header.querySelector('.nav');
                if (nav) {
                    nav.classList.remove('active');
                }
            }
        });
    }
});
</script>


<!-- ***** Preloader Start ***** -->
<div class="js-preloader" id="js-preloader">
<div class="preloader-inner">
<span class="dot"></span>
<div class="dots">
<span></span>
<span></span>
<span></span>
</div>
</div>
</div>
<!-- ***** Preloader End ***** -->
<!-- ***** Header Area Start ***** -->
<header class="header-area header-sticky">
    <div class="menu-trigger" onclick="toggleMobileMenu()">
      <span></span>
      <span></span>
      <span></span>
    </div>
      <div class="container">
          <div class="row">
              <div class="col-12">
                  <nav class="main-nav">

                        <a href="index.html" class="logo">
                            <img src="assets/images/logo.png" alt="">
                        </a>
                      <!-- ***** Logo End ***** -->
                      
                      <!-- ***** Menu Start ***** -->
                      <ul class="nav">
                          <li><a href="index.html">Home</a></li>
                          <li><a href="profile.html">Profile</a></li>
                          <li><a href="explore.html">Explore</a></li>
                          <li><a href="Host-WEB/admin_Login_page.html">Admin</a></li>
                          <li><a href="#" onclick="auth.logout()">Logout</a></li>
                      </ul>
                      <!-- ***** Menu End ***** -->
                       <div class="mobile-menu-trigger">
                            <span></span>
                            <span></span>
                            <span></span>
                        </div>
                  </nav>
              </div>
          </div>
      </div>
  </header>
  <!-- ***** Header Area End ***** -->
<div class="side-nav">
    <div class="side-nav-item" onclick="window.location.href='index.html'">
        <div class="side-nav-icon">
            <i class="fa fa-home"></i>
        </div>
        <div class="side-nav-text">Home</div>
    </div>
    <div class="side-nav-item" onclick="window.location.href='profile.html'">
        <div class="side-nav-icon">
            <i class="fa fa-user"></i>
        </div>
        <div class="side-nav-text">Profile</div>
    </div>
    <div class="side-nav-item" onclick="window.location.href='Host-WEB/admin_Login_page.html'">
        <div class="side-nav-icon">
            <i class="fa fa-cog"></i>
        </div>
        <div class="side-nav-text">Admin</div>
    </div>
</div>
<!-- ***** Main Banner Area Start ***** -->
<div class="main-banner">
  <div class="container">
    <div class="row">
      <div class="col-lg-4 align-self-center">
        <div class="header-text">
          <h1>Product Details</h1>
          <p><h4>View complete information about this product</h4></p>
        </div>
      </div>
    </div>
  </div>
</div>
<!-- ***** Main Banner Area End ***** -->
<!-- ***** Currently Market Area Start ***** -->
<div class="currently-market">
    <div class="container">
        <div class="row">
            <div class="col-lg-12">
                <div class="section-heading">
                    <div class="line-dec"></div>
                    <h2><em>Product</em> Details</h2>
                </div>
            </div>
            <div class="col-lg-12">
                <div class="row currently-market-items">
                    <div class="col-lg-12 currently-market-item">
                        <div class="item">
                            <div class="left-image">
                                <img id="product-image" alt="Product Image" style="border-radius: 20px; max-width: 100%; height: auto; object-fit: cover;"/>
                            </div>
                            <div class="right-content">
                                <h4 id="product-name"></h4>
                                <span class="author"><h2 id="plans-text"></h2></span>
                                <div class="line-dec"></div>
                                <span class="bid">Amount/Day<br><strong id="product-price"></strong>/day</span>
                                <span class="ends">Total Amount<br><strong id="product-total"></strong></span>
                                <span class="category">Category<br><strong id="product-category"></strong></span>
                                <span class="duration">Duration<br><strong id="due-date"></strong> Days</span>
                                <div class="earn-info">
                                    <h3 id="earn-text"></h3>
                                </div>
                                <form id="paymentForm" class="mt-3">
                                    <div class="form-group">
                                        <label for="amount">Enter Amount (â‚¹):</label>
                                        <input 
                                            class="form-control" 
                                            id="amount" 
                                            min="1" 
                                            placeholder="Enter exact amount" 
                                            required 
                                            step="1" 
                                            type="number" />
                                    </div>
                                    <button class="main-button" id="form-submit" type="submit">Apply</button>
                                </form>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
<!-- ***** Currently Market Area End ***** -->

<style>
/* Product Details Page Styling */
.currently-market-item .item {
    background: rgba(40, 43, 47, 0.95);
    border-radius: 20px;
    padding: 40px;
    margin-bottom: 30px;
    box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
    transition: all 0.3s ease;
    border: 1px solid rgba(255, 255, 255, 0.1);
    display: flex;
    flex-direction: row;
    align-items: center;
    gap: 40px;
}

.currently-market-item .item:hover {
    transform: translateY(-5px);
    box-shadow: 0 8px 16px rgba(0, 0, 0, 0.3);
    border-color: rgba(116, 83, 252, 0.5);
}

.currently-market-item .item .left-image {
    flex: 0 0 400px;
    overflow: hidden;
    border-radius: 20px;
}

.currently-market-item .item .left-image img {
    width: 100%;
    height: auto;
    border-radius: 20px;
    object-fit: cover;
    transition: transform 0.3s ease;
}

.currently-market-item .item .left-image img:hover {
    transform: scale(1.05);
}

.currently-market-item .item .right-content {
    flex: 1;
    padding: 0;
}

.currently-market-item .item .right-content h4 {
    color: #fff;
    margin-bottom: 15px;
    font-size: 24px;
}

.currently-market-item .item .right-content .author h2 {
    color: #7453fc;
    font-size: 20px;
    margin-bottom: 20px;
}

.currently-market-item .item .right-content .line-dec {
    width: 60px;
    height: 3px;
    background: #7453fc;
    margin: 0 0 20px 0;
    border-radius: 2px;
}

.currently-market-item .item .right-content .bid,
.currently-market-item .item .right-content .ends,
.currently-market-item .item .right-content .category,
.currently-market-item .item .right-content .duration {
    display: block;
    margin-bottom: 15px;
    color: #b4b2ba;
    font-size: 14px;
}

.currently-market-item .item .right-content .bid strong,
.currently-market-item .item .right-content .ends strong,
.currently-market-item .item .right-content .category strong,
.currently-market-item .item .right-content .duration strong {
    color: #7453fc;
    font-size: 18px;
}

.currently-market-item .item .right-content .earn-info {
    margin: 25px 0;
    padding: 20px;
    background: rgba(116, 83, 252, 0.1);
    border-radius: 15px;
    border: 1px solid rgba(116, 83, 252, 0.3);
}

.currently-market-item .item .right-content .earn-info h3 {
    color: #7453fc;
    font-size: 22px;
    margin: 0;
    text-align: center;
}

.currently-market-item .item .right-content .form-group {
    margin-bottom: 20px;
}

.currently-market-item .item .right-content .form-group label {
    color: #fff;
    margin-bottom: 8px;
    display: block;
}

.currently-market-item .item .right-content .form-control {
    background-color: #37393c;
    border: 1px solid #404245;
    color: #fff;
    border-radius: 8px;
    padding: 12px;
    font-size: 16px;
    width: 100%;
}

.currently-market-item .item .right-content .form-control:focus {
    background-color: #37393c;
    border-color: #7453fc;
    color: #fff;
    box-shadow: 0 0 0 0.25rem rgba(116, 83, 252, 0.25);
}

.currently-market-item .item .right-content .main-button {
    background: #7453fc;
    color: #fff;
    padding: 12px 30px;
    border-radius: 25px;
    text-decoration: none;
    display: inline-block;
    border: none;
    font-size: 16px;
    cursor: pointer;
    transition: all 0.3s ease;
}

.currently-market-item .item .right-content .main-button:hover {
    background: #5b42c7;
    transform: translateY(-2px);
    box-shadow: 0 4px 8px rgba(116, 83, 252, 0.3);
}

/* Mobile responsive styles for product details */
@media (max-width: 768px) {
    .currently-market-item .item {
        flex-direction: column;
        padding: 25px;
        gap: 25px;
        text-align: center;
    }
    
    .currently-market-item .item .left-image {
        flex: none;
        width: 100%;
        max-width: 300px;
    }
    
    .currently-market-item .item .right-content {
        text-align: center;
    }
    
    .currently-market-item .item .right-content .line-dec {
        margin: 0 auto 20px auto;
    }
    
    .currently-market-item .item .right-content .bid,
    .currently-market-item .item .right-content .ends,
    .currently-market-item .item .right-content .category,
    .currently-market-item .item .right-content .duration {
        text-align: center;
    }
}

/* Additional styles for existing elements */
.item-details-page .row > div {
    padding: 15px;
}

/* Main Navigation Styles */
.main-nav {
    display: grid;
    grid-template-columns: auto 1fr auto;
    align-items: center;
    position: relative;
    padding: 15px 0;
    max-width: 1200px;
    margin: 0 auto;
}

.logo-container {
    position: relative;
    left: 50%;
    transform: translateX(-50%);
    text-align: center;
    z-index: 1;
}

.logo img {
    width: 220px;
    height: auto;
    max-width: 100%;
    margin: 0 auto;
}

/* Header Area Styles */
.header-area {
    background: rgba(1, 11, 44, 0.9);
    backdrop-filter: blur(5px);
    -webkit-backdrop-filter: blur(5px);
    border-bottom: 1px solid rgba(255, 255, 255, 0.1);
    position: fixed;
    top: 0;
    left: 0;
    right: 0;
    z-index: 100;
}

/* Main Banner Styles */
.main-banner {
    background-image: url(assets/images/banner-bg.jpg);
    background-position: center center;
    background-repeat: no-repeat;
    background-size: cover;
    padding: 100px 0px;
    margin-bottom: 60px;
    border-radius: 0px;
    position: relative;
}

.main-banner::before {
    content: '';
    position: absolute;
    top: 0;
    left: 0;
    right: 0;
    bottom: 0;
    background: rgba(0, 0, 0, 0.5);
    border-radius: 0px;
}

.main-banner .container {
    position: relative;
    z-index: 1;
}

.main-banner .header-text {
    padding: 0;
    margin: 20px 0;
    text-align: center;
}

.main-banner .header-text h1 {
    font-size: 32px;
    margin-bottom: 15px;
    color: #fff;
    text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.7);
}

.main-banner .header-text h4 {
    font-size: 18px;
    color: #b4b2ba;
    line-height: 1.6;
    text-shadow: 1px 1px 2px rgba(0, 0, 0, 0.7);
}

/* Section Heading Styles */
.section-heading {
    margin-bottom: 30px;
    text-align: center;
}

.section-heading h2 {
    font-size: 32px;
    color: #fff;
    margin-bottom: 15px;
}

.section-heading .line-dec {
    width: 60px;
    height: 3px;
    background: #7453fc;
    margin: 0 auto 20px auto;
    border-radius: 2px;
}

/* Currently Market Section Styles */
.currently-market {
    padding: 80px 0;
    background: rgba(40, 43, 47, 0.95);
    border-radius: 20px;
    margin: 20px 0;
}

.currently-market-items {
    display: grid;
    grid-template-columns: 1fr;
    gap: 30px;
}

/* Desktop Navigation Styles */
@media (min-width: 992px) {
    .menu-trigger {
        display: none;
    }
    
    .nav {
        display: flex !important;
        position: static;
        background: none;
        padding: 0;
        box-shadow: none;
        width: auto;
    }
    
    .nav li {
        display: inline-block;
        margin: 0 15px;
    }
    
    .nav li a {
        color: #fff;
        text-decoration: none;
        padding: 10px 15px;
        border-radius: 20px;
        transition: all 0.3s ease;
    }
    
    .nav li a:hover {
        background: rgba(116, 83, 252, 0.2);
        color: #7453fc;
    }
    
    .main-nav {
        display: grid;
        justify-content: space-between;
        grid-template-columns: auto 1fr auto;
        align-items: center;
        gap: 10px;
        padding: 10px 15px;
    }
    
    .logo-container {
        position: relative;
        text-align: center;
        z-index: 1;
        transform: none;
    }
}

.bid, .category, .ends {
    margin-bottom: 20px;
    text-align: center;
}

#paymentForm {
    padding: 15px;
}

.user-account-info {
    margin: 20px auto;
    max-width: 300px;
    display: flex;
    align-items: center;
    background: rgba(116, 83, 252, 0.1);
    padding: 10px 15px;
    border-radius: 15px;
    border: 1px solid rgba(116, 83, 252, 0.3);
    transition: all 0.3s ease;
    cursor: pointer;
}

.user-account-info:hover {
    background: rgba(116, 83, 252, 0.2);
    border-color: #7453fc;
    transform: scale(1.05);
}

.user-profile-pic {
    width: 40px;
    height: 40px;
    border-radius: 50%;
    overflow: hidden;
    margin-right: 10px;
    border: 2px solid #b4b2ba;
}

.user-profile-pic img {
    width: 100%;
    height: 100%;
    object-fit: cover;
}

.user-balance-info {
    text-align: left;
}

.balance-amount {
    font-weight: bold;
    color: #7453fc;
    font-size: 16px;
}

.balance-label {
    font-size: 12px;
    color: #afafaf;
}

/* Side Navigation Styles */
.side-nav {
    position: fixed;
    left: 0;
    top: 50%;
    transform: translateY(-50%);
    background: rgba(40, 43, 47, 0.95);
    padding: 15px;
    border-radius: 0 15px 15px 0;
    z-index: 1000;
    backdrop-filter: blur(8px);
    border: 1px solid rgba(255, 255, 255, 0.1);
    box-shadow: 0 2px 10px rgba(0, 0, 0, 0.3);
}

.side-nav-item {
    display: flex;
    align-items: center;
    margin: 20px 0;
    cursor: pointer;
    transition: all 0.3s;
}

.side-nav-icon {
    width: 40px;
    height: 40px;
    display: flex;
    align-items: center;
    justify-content: center;
    background: #7453fc;
    border-radius: 50%;
    margin-right: 15px;
}

.side-nav-icon i {
    color: white;
    font-size: 18px;
}

.side-nav-text {
    color: white;
    opacity: 0;
    width: 0;
    overflow: hidden;
    white-space: nowrap;
    transition: all 0.3s;
}

.side-nav:hover .side-nav-text {
    opacity: 1;
    width: 120px;
}

/* Mobile Side Navigation */
@media (max-width: 767px) {
    .side-nav {
        bottom: 0;
        top: auto;
        left: 0;
        right: 0;
        transform: none;
        display: flex;
        justify-content: space-around;
        border-radius: 15px 15px 0 0;
        padding: 8px;
        z-index: 1001;
    }
    
    .side-nav-item {
        margin: 3px;
        flex-direction: column;
    }
    
    .side-nav-icon {
        margin-right: 0;
        margin-bottom: 3px;
        width: 30px;
        height: 20px;
    }
    
    .side-nav-text {
        opacity: 1;
        width: auto;
        font-size: 10px;
    }
}

/* Preloader Styles */
.js-preloader {
    position: fixed;
    top: 0;
    left: 0;
    right: 0;
    bottom: 0;
    background-color: rgba(0,0,0,0.98);
    display: flex;
    align-items: center;
    justify-content: center;
    opacity: 1;
    visibility: visible;
    z-index: 9999;
    transition: opacity 0.25s ease;
}

.js-preloader.loaded {
    opacity: 0;
    visibility: hidden;
    pointer-events: none;
}

.preloader-inner {
    text-align: center;
}

.dot {
    width: 20px;
    height: 20px;
    background: #7453fc;
    border-radius: 50%;
    display: inline-block;
    margin: 0 5px;
    animation: pulse 1.5s infinite;
}

.dots span {
    width: 15px;
    height: 15px;
    background: #7453fc;
    border-radius: 50%;
    display: inline-block;
    margin: 0 3px;
    animation: pulse 1.5s infinite;
    animation-delay: 0.2s;
}

.dots span:nth-child(2) {
    animation-delay: 0.4s;
}

.dots span:nth-child(3) {
    animation-delay: 0.6s;
}

@keyframes pulse {
    0%, 100% { transform: scale(1); opacity: 1; }
    50% { transform: scale(1.2); opacity: 0.7; }
}

/* Body Background */
body {
    background-color: #1e1e1e;
    background-image: url(assets/images/dark-bg.jpg);
    background-size: cover;
    background-attachment: fixed;
    background-position: center;
    color: #fff;
    transition: background-color 0.3s ease, color 0.3s ease;
}

/* Mobile Main Banner */
@media (max-width: 576px) {
    .main-banner {
        padding: 60px 0 30px 0;
    }
    
    .main-banner .header-text h1 {
        font-size: 24px;
        margin-bottom: 15px;
    }
    
    .main-banner .header-text h4 {
        font-size: 16px;
    }
    
    .currently-market {
        padding: 40px 0;
        margin: 10px 0;
    }
    
    .section-heading h2 {
        font-size: 20px;
    }
}

/* Mobile Menu Styles */
.mobile-menu-trigger {
    display: none;
    width: 30px;
    height: 25px;
    position: relative;
    cursor: pointer;
    margin-right: 15px;
}

.mobile-menu-trigger span {
    display: block;
    position: absolute;
    height: 3px;
    width: 100%;
    background: #7453fc;
    border-radius: 3px;
    transition: 0.25s ease-in-out;
}

.mobile-menu-trigger span:nth-child(1) { top: 0; }
.mobile-menu-trigger span:nth-child(2) { top: 10px; }
.mobile-menu-trigger span:nth-child(3) { top: 20px; }

/* Active State */
.mobile-menu-trigger.active span:nth-child(1) {
    top: 10px;
    transform: rotate(45deg);
}

.mobile-menu-trigger.active span:nth-child(2) {
    opacity: 0;
}

.mobile-menu-trigger.active span:nth-child(3) {
    top: 10px;
    transform: rotate(-45deg);
}

@media (max-width: 991px) {
    .mobile-menu-trigger {
        display: block;
    }

    .nav {
        display: none;
        position: absolute;
        top: 80px;
        left: 0;
        width: 100%;
        background: rgba(255, 255, 255, 0.95);
        padding: 20px 0;
        box-shadow: 0 2px 15px rgba(0,0,0,0.1);
    }

    .nav.active {
        display: block;
    }

    .nav li {
        display: block;
        margin: 0;
        padding: 8px 25px;
    }

    .nav li a {
        display: block;
        padding: 8px 0;
        color: #7453fc;
    }
}
</style>

<footer>
<div class="container">
<div class="row">
<div class="col-lg-12">
<p>Copyright Â© 2022 <a href="#">Liberty</a> NFT Marketplace Co., Ltd. All rights reserved.
          Â Â 
            <a href="https://templatemo.com/privacy-policy" target="_blank">Privacy Policy</a>
          Â Â 
            <a href="https://templatemo.com/terms-conditions" target="_blank">Terms & Conditions</a>
        </p>
</div>
</div>
</div>
</footer>
<!-- Scripts -->

<!-- Bootstrap core JavaScript -->







<!-- Payment Handling Scripts -->
<!-- Add this CSS somewhere in head or a styles file -->

<!-- Payment script (paste near other scripts) -->

<!-- Payment Modal -->
<div class="modal fade" id="paymentModal">
<div class="modal-dialog modal-dialog-centered">
<div class="modal-content">
<div class="modal-header">
<h5 class="modal-title">Choose Payment Method</h5>
<button class="btn-close" data-bs-dismiss="modal" type="button"></button>
</div>
<div class="modal-body">
<div class="payment-amount">
                    Amount to Pay: <span id="paymentAmount"></span>
</div>
<div class="payment-methods">
<button class="payment-method-btn" onclick="handleUPIPayment()">
<img alt="UPI" src="assets/images/upi-icon.png"/>
<span>UPI / QR Code</span>
</button>
<button class="payment-method-btn" onclick="handleCardPayment()">
<img alt="Card" src="assets/images/card-icon.png"/>
<span>Card / NetBanking</span>
</button>
</div>
</div>
</div>
</div>
</div>
<!-- Agreement Modal -->
<div class="modal fade" id="agreementModal">
<div class="modal-dialog modal-dialog-centered">
<div class="modal-content">
<div class="modal-header">
<h5 class="modal-title">Terms & Conditions</h5>
<button class="btn-close" data-bs-dismiss="modal" type="button"></button>
</div>
<div class="modal-body">
<div class="agreement-content">
    <h6 class="mb-3">Please read and agree to the following terms:</h6>
    <ul class="mb-4">
        <li>I understand that this payment is for the selected product/service.</li>
        <li>I confirm that I am authorized to make this payment.</li>
        <li>NOTICE - during upi payment , if payment less than actual total payment then war begin between you and another person.</li>
        <li>if competitor pay greater then you and service more than you then he win and you lose this service.</li>
        <li>if you pay greater then actual total payment then you win and competitor lose this service.</li>
        <li>I agree to the terms of service and privacy policy.</li>
    </ul>
</div>
<div class="text-center">
    <button class="btn btn-primary" id="agreeBtn">I Agree & Continue</button>
    <button class="btn btn-outline-secondary mt-2" data-bs-dismiss="modal">Cancel</button>
</div>
</div>
</div>
</div>
</div>

<!-- UPI Payment Modal -->
<div class="modal fade" id="upiModal">
<div class="modal-dialog modal-dialog-centered">
<div class="modal-content">
<div class="modal-header">
<h5 class="modal-title">Pay using UPI</h5>
<button class="btn-close" data-bs-dismiss="modal" type="button"></button>
</div>
<div class="modal-body text-center">
<div class="payment-amount">
    Amount to Pay: <span id="upiAmount"></span>
</div>
<div class="qr-code-container mt-3">
    <img src="assets/images/Gpay-QR.jpg" alt="QR Code" class="img-fluid"/>
</div>
<p class="mb-3 mt-2"><small>UPI ID: <strong>kum444kartik@okicici</strong></small></p>
<div class="upi-apps-title">Or pay directly with:</div>
<div class="upi-apps mt-2">
    <button class="upi-btn" onclick="openUpiApp('gpay')">
        <img alt="GPay" src="assets/images/gpay.png"/>
        <span>Google Pay</span>
    </button>
    <button class="upi-btn" onclick="openUpiApp('phonepe')">
        <img alt="PhonePe" src="assets/images/phonepe.png"/>
        <span>PhonePe</span>
    </button>
    <button class="upi-btn" onclick="openUpiApp('paytm')">
        <img alt="Paytm" src="assets/images/paytm.png"/>
        <span>Paytm</span>
    </button>
    <button class="upi-btn" onclick="openUpiApp('bhim')">
        <img alt="BHIM" src="assets/images/bhim.png"/>
        <span>BHIM</span>
    </button>
</div>
<div class="mt-4">
    <button class="btn btn-primary" id="verifyUPIPaymentBtn" onclick="verifyUPIPayment()">I've paid â€” Verify Payment</button>
    <button class="btn btn-outline-secondary mt-2" data-bs-dismiss="modal">Cancel</button>
</div>
</div>
</div>
</div>
</div>




<script>
// Initialize currentProduct as a global variable
let currentProduct = {};

// Define category class mapping function
function getCategoryClass(category) {
    const classMap = {
        'basic': 'msc',
        'standard': 'dig',
        'Earphone': 'blc',
        'premium': 'vtr'
    };
    return classMap[category] || '';
}

async function loadProducts() {
    // Always try to fetch from API first for live data
    let products = [];
    let fetchError = false;
    
    try {
        // Determine API base URL based on environment
        const API_BASE = window.location.hostname === 'localhost' || window.location.hostname.includes('127.0.0.1')
            ? 'http://localhost:3000'
            : 'https://liberty-market.onrender.com';
            
        console.log('Using API base:', API_BASE);
        
        const resp = await fetch(`${API_BASE}/api/products`, {
            cache: 'no-store',
            headers: { 'Cache-Control': 'no-cache' }
        });
        
        if (!resp.ok) {
            throw new Error(`Server returned ${resp.status}`);
        }
        
        products = await resp.json();
        console.log('Fetched products from API:', products);
        console.log('First product image path:', products[0]?.image);
        console.log('First product structure:', products[0]);
        console.log('First product keys:', products[0] ? Object.keys(products[0]) : 'No products');
        
        // Save to localStorage as backup
        localStorage.setItem('server_products', JSON.stringify(products));
    } catch (err) {
        console.error('Error fetching products from API:', err);
        console.error('Error details:', {
            message: err.message,
            stack: err.stack,
            name: err.name
        });
        fetchError = true;
        
        // Try to get products from localStorage backup
        const serverProducts = JSON.parse(localStorage.getItem('server_products') || '[]');
        if (serverProducts.length > 0) {
            products = serverProducts;
            console.log('Using cached server products from localStorage');
            console.log('First cached product image:', products[0]?.image);
            console.log('First cached product structure:', products[0]);
            console.log('First cached product keys:', products[0] ? Object.keys(products[0]) : 'No products');
        }
    }
    
    // If API fetch failed and no server products in cache, fall back to localStorage products
    if (fetchError && products.length === 0) {
        products = JSON.parse(localStorage.getItem('products') || '[]');
        console.log('Using local products from localStorage');
        console.log('First local product image:', products[0]?.image);
        console.log('First local product structure:', products[0]);
        console.log('First local product keys:', products[0] ? Object.keys(products[0]) : 'No products');
    }
    
    // Map products to display format with consistent property names
    const mappedProducts = products.map(p => {
        console.log('Mapping product:', p);
        const mapped = {
            id: p._id || p.id,
            image: p.image,
            name: p.name,
            Plans: p.plans || p.Plans || '',  // Support both cases
            price: p.price || p.pricePerDay || 0,
            total: p.total || p.totalAmount || 0,
            category: p.category || '',
            categoryClass: (typeof getCategoryClass === 'function') ? getCategoryClass(p.category || '') : '',
            earn: p.earn || p.price || p.pricePerDay || 0,
            days: p.days || p.duration || '30'
        };
        console.log('Mapped to:', mapped);
        return mapped;
    });
    
    console.log('Mapped products:', mappedProducts);
    return mappedProducts;
}


// Menu Trigger Functionality
document.addEventListener('DOMContentLoaded', function() {
  const header = document.querySelector('.header-area .main-nav');
  if (header) {
    // Check if menu trigger already exists
    let menuTrigger = header.querySelector('.menu-trigger');
    
    // If menu trigger doesn't exist, create it
    if (!menuTrigger) {
      menuTrigger = document.createElement('a');
      menuTrigger.className = 'menu-trigger';
      menuTrigger.href = '#';
      
      // Create hamburger icon
      const span1 = document.createElement('span');
      const span2 = document.createElement('span');
      const span3 = document.createElement('span');
      
      menuTrigger.appendChild(span1);
      menuTrigger.appendChild(span2);
      menuTrigger.appendChild(span3);
      
      // Add menu trigger to header
      header.appendChild(menuTrigger);
      
      // Add click event to menu trigger
      menuTrigger.addEventListener('click', function(e) {
        e.preventDefault();
        this.classList.toggle('active');
        const nav = header.querySelector('.nav');
        if (nav) {
          nav.classList.toggle('active');
        }
      });

      // Close menu when clicking outside
      document.addEventListener('click', function(e) {
        if (!e.target.closest('.nav') && !e.target.closest('.menu-trigger')) {
          menuTrigger.classList.remove('active');
          const nav = header.querySelector('.nav');
          if (nav) {
            nav.classList.remove('active');
          }
        }
      });
    }
  }
});

document.addEventListener('DOMContentLoaded', async function() {
    console.log('DOM Content Loaded event fired');
    console.log('Document ready state:', document.readyState);
    console.log('Body element exists:', !!document.body);
    console.log('Product image element exists at load:', !!document.getElementById('product-image'));
    
    // Simple alert to confirm the script is running
    alert('Details page script loaded successfully! Check console for debugging info.');
    
    // Also check on window load
    window.addEventListener('load', function() {
        console.log('Window load event fired');
        console.log('Document ready state on window load:', document.readyState);
        console.log('Product image element exists on window load:', !!document.getElementById('product-image'));
    });
    
    // Check if updateUserBalance function exists before calling it
    if (typeof updateUserBalance === 'function') {
        console.log('updateUserBalance function found, calling it');
        updateUserBalance();
    } else {
        console.log('updateUserBalance function not found');
    }

    const urlParams = new URLSearchParams(window.location.search);
    const productId = urlParams.get('id');
    
    console.log('Current page URL:', window.location.href);
    console.log('URL parameters:', window.location.search);
    console.log('Product ID from URL:', productId);

    if (!productId) {
        console.error('No product ID found in URL');
        return;
    }
    
    // Load all products using the same function as index.html
    console.log('About to call loadProducts()...');
    const products = await loadProducts();
    console.log('All products loaded:', products);
    console.log('Looking for product with ID:', productId);
    
    const product = products.find(p => p.id == productId);
    console.log('Found product:', product);
    
    if (!product) {
        console.error('Product not found!');
        alert('Product not found!');
        return;
    }
    
    // Validate product data
    console.log('Validating product data...');
    if (!product.name) {
        console.error('Product name is missing!');
        product.name = 'Unknown Product';
    }
    if (!product.image) {
        console.error('Product image is missing!');
        product.image = 'assets/images/item-details-01.jpg';
    }
    if (!product.category) {
        console.error('Product category is missing!');
        product.category = 'Unknown Category';
    }
    
    // Test basic DOM manipulation
    console.log('Testing basic DOM manipulation...');
    const testElement = document.getElementById('product-name');
    if (testElement) {
        console.log('Product name element found, setting test text');
        testElement.textContent = 'TESTING - ' + product.name;
    } else {
        console.error('Product name element not found!');
    }

    // Populate all HTML elements with product data
    console.log('Product data:', product);
    console.log('Product image path:', product.image);
    console.log('Product properties:', Object.keys(product));
    console.log('Product image property exists:', 'image' in product);
    console.log('Product image property value:', product.image);
    console.log('Product image property type:', typeof product.image);
    
    const productImageElement = document.getElementById('product-image');
    console.log('Product image element:', productImageElement);
    console.log('All elements with id "product-image":', document.querySelectorAll('#product-image'));
    
    if (productImageElement) {
        console.log('Product image element properties:', {
            tagName: productImageElement.tagName,
            id: productImageElement.id,
            className: productImageElement.className,
            style: productImageElement.style.cssText,
            currentSrc: productImageElement.currentSrc,
            src: productImageElement.src
        });
        
        // Ensure image path is correct
        let imagePath = product.image;
        console.log('Original image path:', imagePath);
        console.log('Image path type:', typeof imagePath);
        
        if (imagePath && !imagePath.startsWith('http') && !imagePath.startsWith('data:')) {
            // If it's a relative path, make sure it starts with the correct path
            if (!imagePath.startsWith('assets/') && !imagePath.startsWith('./assets/')) {
                imagePath = 'assets/images/' + imagePath;
                console.log('Modified image path to:', imagePath);
            }
        }
        
        console.log('Final image path:', imagePath);
        console.log('Setting image src to:', imagePath);
        
        // Test if the image URL is accessible
        if (imagePath && imagePath.startsWith('http')) {
            console.log('Testing HTTP image URL accessibility...');
            fetch(imagePath, { method: 'HEAD' })
                .then(response => {
                    console.log('Image URL test response:', response.status, response.statusText);
                })
                .catch(error => {
                    console.error('Image URL test failed:', error);
                });
        }
        
        productImageElement.src = imagePath;
        productImageElement.alt = product.name;
        
        // Add error handling for image loading
        productImageElement.onerror = function(e) {
            console.error('Failed to load image:', imagePath);
            console.error('Error event:', e);
            console.error('Error target:', e.target);
            console.error('Error type:', e.type);
            
            // Try fallback image
            console.log('Trying fallback image: assets/images/item-details-01.jpg');
            productImageElement.src = 'assets/images/item-details-01.jpg';
        };
        productImageElement.onload = function() {
            console.log('Image loaded successfully:', imagePath);
            console.log('Image dimensions after load:', {
                naturalWidth: productImageElement.naturalWidth,
                naturalHeight: productImageElement.naturalHeight,
                offsetWidth: productImageElement.offsetWidth,
                offsetHeight: productImageElement.offsetHeight,
                clientWidth: productImageElement.clientWidth,
                clientHeight: productImageElement.clientHeight
            });
            
            // Test if image is actually visible
            const rect = productImageElement.getBoundingClientRect();
            console.log('Image bounding rect:', rect);
            console.log('Image is visible:', rect.width > 0 && rect.height > 0);
        };
        
        // Add timeout to check if image loads
        console.log('Setting timeout for image load check...');
        const timeoutId = setTimeout(() => {
            console.log('Timeout fired, checking image status...');
            console.log('Image complete:', productImageElement.complete);
            console.log('Image natural height:', productImageElement.naturalHeight);
            console.log('Image current src:', productImageElement.src);
            console.log('Image computed styles:', {
                display: window.getComputedStyle(productImageElement).display,
                visibility: window.getComputedStyle(productImageElement).visibility,
                opacity: window.getComputedStyle(productImageElement).opacity,
                width: window.getComputedStyle(productImageElement).width,
                height: window.getComputedStyle(productImageElement).height
            });
            
            // Check if image is actually visible
            const rect = productImageElement.getBoundingClientRect();
            console.log('Image bounding rect at timeout:', rect);
            console.log('Image is visible at timeout:', rect.width > 0 && rect.height > 0);
            
            if (productImageElement.complete && productImageElement.naturalHeight === 0) {
                console.error('Image failed to load within timeout, trying fallback');
                productImageElement.src = 'assets/images/item-details-01.jpg';
            }
        }, 5000);
        
        console.log('Timeout ID:', timeoutId);
        
        // Additional debugging - check network requests
        console.log('Checking network requests for image...');
        const performanceEntries = performance.getEntriesByType('resource');
        const imageRequests = performanceEntries.filter(entry => entry.name.includes(imagePath));
        console.log('Image network requests:', imageRequests);
        
        // Check if image is in DOM and visible
        console.log('Image element in DOM:', document.contains(productImageElement));
        console.log('Image parent element:', productImageElement.parentElement);
        console.log('Image parent visibility:', productImageElement.parentElement ? window.getComputedStyle(productImageElement.parentElement).display : 'No parent');
        
        // Force image to be visible
        console.log('Forcing image to be visible...');
        productImageElement.style.display = 'block';
        productImageElement.style.visibility = 'visible';
        productImageElement.style.opacity = '1';
        productImageElement.style.width = 'auto';
        productImageElement.style.height = 'auto';
        
        // Add a border to make it more visible
        productImageElement.style.border = '2px solid red';
        productImageElement.style.backgroundColor = 'yellow';
        
    } else {
        console.error('Product image element not found!');
    }
    
    document.getElementById('product-name').textContent = product.name;
    document.getElementById('product-category').textContent = product.category;
    document.getElementById('product-total').textContent = `â‚¹${product.total || 0}`;
    document.getElementById('due-date').textContent = product.days || '100';
    document.getElementById('plans-text').textContent = product.Plans;
    document.getElementById('product-price').textContent = `â‚¹${product.price || product.earn || 0}`;
    document.getElementById('earn-text').textContent = `Earn â‚¹${product.earn || product.price || 0} daily`;

    const amountInput = document.getElementById('amount');
    if (amountInput) {
        amountInput.value = product.total || 0;
    }

    // Initialize currentProduct before trying to access its properties
    currentProduct = product;
    
    // Now that currentProduct is initialized, we can set its properties
    if (currentProduct) {
        currentProduct.total = product.total || 0;
        currentProduct.price = product.price || product.earn || 0;
    }
    
    // Remove any existing success modal that might be showing
    const existingSuccessModal = document.querySelector('.success-modal');
    if (existingSuccessModal) {
        existingSuccessModal.remove();
    }
    
    // Set up Apply button functionality
    const paymentForm = document.getElementById('paymentForm');
    if (paymentForm) {
        paymentForm.addEventListener('submit', function(e) {
            e.preventDefault();
            const amount = document.getElementById('amount').value;
            if (amount) {
                openPaymentModal(amount);
            }
        });
    }
});

// Add this function where needed
async function buyProduct(productId) {
  try {
    const paymentMethod = document.querySelector('input[name="payMethod"]:checked')?.value;
    if (!paymentMethod) { alert('Select payment method'); return; }

    const price = Number(document.getElementById('productPrice')?.dataset.price || 0);

    // If UPI, construct UPI URI to open installed UPI app (user will complete payment in UPI app)
    if (paymentMethod === 'upi') {
      const merchantUPI = 'kumm444kartik@okicici'; // host UPI ID
      const merchantName = 'INVESTLOOM7X';
      const txnRef = 'TXN' + Date.now();
      const upiUrl = `upi://pay?pa=${encodeURIComponent(merchantUPI)}&pn=${encodeURIComponent(merchantName)}&am=${price}&tr=${txnRef}&cu=INR`;
      // open UPI app (mobile)
      window.location.href = upiUrl;

      // After user pays, they must enter txnRef or the app may return a response to the browser.
      // Prompt user for transaction reference (simple verification flow)
      const userTxn = prompt('After completing UPI payment, enter transaction reference (UTR/Ref):', txnRef);
      if (!userTxn) { alert('Payment not confirmed'); return; }

      // Call backend purchase with txnRef
      const res = await fetch('/api/purchase', {
        method: 'POST',
        headers: { 'Content-Type': 'application/json' },
        credentials: 'include',
        body: JSON.stringify({ productId, paymentMethod: 'upi', txnRef: userTxn })
      });
      const data = await res.json();
      if (res.ok && data.success) {
        alert('Purchase successful. Balance: â‚¹' + (data.balance ?? 0));
        window.location.href = 'profile.html';
      } else {
        alert('Purchase failed: ' + (data.error || 'Unknown'));
      }
      return;
    }

    // For card/netbank: gather details or use balance
    let payload = { productId, paymentMethod };
    // if user has saved bank/card, you can skip; else ask for details
    if (paymentMethod === 'card') {
      const cardNum = prompt('Enter card number (demo):');
      const nama = prompt('Card holder name:');
      if (!cardNum) { alert('Card required'); return; }
      payload.cardInfo = { cardNum: cardNum.slice(-4), holder: nama || '' };
    } else if (paymentMethod === 'netbank') {
      const bankRef = prompt('Enter bank transaction reference (demo):');
      if (!bankRef) { alert('Bank txn required'); return; }
      payload.bankInfo = { ref: bankRef };
    }

    // Send purchase request
    const resp = await fetch('/api/purchase', {
      method: 'POST',
      headers: { 'Content-Type': 'application/json' },
      credentials: 'include',
      body: JSON.stringify(payload)
    });
    const result = await resp.json();
    if (resp.ok && result.success) {
      alert('Purchase successful. Balance: â‚¹' + (result.balance ?? 0));
      window.location.href = 'profile.html';
    } else {
      alert('Purchase failed: ' + (result.error || 'Unknown'));
    }
  } catch (err) {
    console.error(err);
    alert('Purchase error, see console');
  }
}
</script>

